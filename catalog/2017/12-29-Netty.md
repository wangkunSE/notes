## 一 Netty的概念及体系结构

### 一 Netty--异步和事件驱动

#### 1.1 Java网络编程

>  一个连接需要一个线程。
>
>  - 大部分线程处于休眠状态的情况下十分浪费时间。
>  - 需要为每一个线程分配内存，默认值大小区间为64KB到1MB。
>  - 当线程达到一个量级时，上下文切换的开销会非常大。

##### 1.1.1 Java NIO

> 非阻塞IO

##### 1.1.2 选择器 Selector

> 一个单一的线程便可以处理多个并发的连接。
>
> - 使用较少的线程便可以处理许多连接。
> - 当没有I/O操作需要处理的时候，线程可以被用于其他任务。

#### 1.2 Netty简介

> 对Java NIO底层API的一层封装。

##### 1.2.1 谁在使用Netty

> Cassandra 、Vert.x 、Twitter

##### 1.2.2 异步和事件驱动

> - 异步方法会立即返回，并且在它完成时，会直接或者在稍后的某个时间点通知用户。
> - 选择器使得我们能通过较少的线程便可监视许多连接上的事件。

#### 1.3 Netty的核心组件

##### 1.3.1 Channel

> 一个到实体的开放连接，如读操作和写操作。

##### 1.3.2 回调

> 一个回调就是一个方法，一个指向被提供给另外一个方法的方法的引用。

##### 1.3.3 Future

> ChannelFuture

##### 1.3.4 事件和ChannelHandler

> Netty基于事件发生动作，ChannelHandler是Netty对这些事件处理器的抽象。同时Netty也实现了很多开箱即用的ChannelHandler。

##### 1.3.5 组合

> Netty的异步编程模型是建立在Future和回调的概念之上的。
>
> 在Netty内部，将会为每个Channel分配一个EventLoop，用来处理所有的事件，包括：
>
> - 注册感兴趣的事件
> - 将事件派发给ChannelHandler
> - 安排进一步的动作

### 二 Netty初体验

**Echo服务器与客户端**

> 虽然交互十分简单，但是其充分地体现了客户端/服务器系统中的典型请求-响应交互模式。

> **关于ChannelHandler的关键点：**
>
> - 针对不同类型的事件来调用ChannelHandler
> - 应用程序通过实现或者扩展ChannelHandler来挂钩到事件的生命周期，并且提供自定义的应用程序逻辑
> - 在架构上，ChannelHandler有助于保持业务逻辑与网络处理代码的分离。这简化了开发过程，因为代码必须不断地演化以响应不断变化的需求。

### 三 Netty的组件和设计

> 